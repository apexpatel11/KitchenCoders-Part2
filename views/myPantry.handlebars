



{{! ************* MAIN HEADING ********************************** --}}
<div class="background-area content">
  <div class="container paddingBlock">
    <div class="equalHWrap eqWrap">
      <h1 class="heading"><span>AVOIDING THE GROCERY STORE?&nbspLET'S SEE WHAT YOU HAVE ON HAND</span></h1>
    </div>
    {{! ************* DIVISION FOR INGREDIENTS IN PANTRY ************************** -}}
    <div class="col-md-6 ingredients">
      <div class="equalHW eq">
        <div class="containerTitle">
          <div class="panel panel-default">
            <div class="panel-heading">Ingredients
            </div>
            <div class="panel-body">
              <div class="ingredientContainer" id="pantryList">
                {{! ***** ingredients go here}}

                {{#each categories}} 
                  <div>
                    <h4 class="categorySection">{{this.className}}<i class="fa fa-hand-o-down pull-right"></i></h4>
                    <ul class = "list-group categoryUL catID{{this.id}}">

                    </ul>
                  </div>
                {{/each}}

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    {{! ************* DIVISION FOR FORM TO ADD INGREDIENT}}
    <div class="col-md-6 ingredients">
      <div class="equalHWrap eqWrap">
        <div class="containerTitle">
          <div class="panel panel-default">
            <div class="panel-heading">Add New Ingredients Here</div>
            <div class="panel-body">
              <form role="form" class="create-update-form" action="ingredient/update" method="POST">
                <div class="form-group">
                  <!-- Here we create the text box for capturing the search term-->
                  <label for="search">
                  </label>
                  </br>
                  <input type="text" class="form-control" id="bu" name="name">
                  </br>
                  <div class="categoryContainer" id="categoryList">
                    <select name="category" class="form-control" id="categoryOptions">

                    {{#each categories}}
                      <option value="{{this.name}}">{{this.className}}</option>
                    {{/each}}

                    </select>
                  </div>
                  </br>
                  </br>
                  </br>
                  <button id="add" type="submit" class="btn btn-default" ><i class="fa fa-check-square"></i> Add Now</button>
                  <button type="button" class="btn btn-default" id="clearAll"><i class="fa fa-trash"></i> Clear Results</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div> 

</div> {{!end of block div}}



{{!  ******************SCRIPT FILE HERE *****************}}
<script>
  {{! *** CREATE THE HTML FOR EACH INGREDIENT ****}}
  {{! ********* AND APPEND IT TO THE APPROPRIATE DIVISION *******}} 
  {{#each ingredients}}


    var ingredientLI = $('<li>');

    var statusStyle =({{this.inPantry}} ? "inPantryStyle" : "allOutStyle");
    var changeStatusTo = ({{this.inPantry}} ? "0" : "1");
    
    ingredientLI.append('<button data-id="{{this.id}}" data-pantryStatus="' + changeStatusTo + '" class="list-group-item ingrButton ' + statusStyle + '" type="button">{{this.name}}</button>');


    $('#pantryList').find('.catID{{this.CategoryId}}').append(ingredientLI);
      
  {{/each}}

  $(document).ready(function() {
    $('.categorySection').on('click', function(event){
      console.log("this was clicked");
      event.stopPropagation();
      $(this).closest('div').find('.categoryUL').slideToggle();
      })


    $('#pantryList').on('click', '.ingrButton', function(){
      var updateURL = "myPantry/update/" + $(this).attr('data-id');
      var ingButton = $(this);
      var value = $(this).attr('data-pantryStatus');
      $.post(updateURL,
        {inPantry: value}, 
        function(result){
          if(result == "0"){
            ingButton.removeClass('inPantryStyle');
            ingButton.addClass('allOutStyle');
            ingButton.attr('data-pantryStatus', '1');
          } else {
            ingButton.removeClass('allOutStyle');
            ingButton.addClass('inPantryStyle');
            ingButton.attr('data-pantryStatus', '0');
          }
        })
    });

  });


</script>