



{{! ************* MAIN HEADING ********************************** --}}
<div class="background-area content">
  <div class="containerTitle blurBackground">
    <h1 class="heading">What's in the pantry?</h1>
  </div>
  <div class="container">
    {{! ************* DIVISION FOR LIST OF CATEGORIES ************************** -}}
    <div class="col-md-4">
      <div class="panel panel-default">
        <div class="panel-heading">Select A Category
        </div>
        <div class="panel-body">
          <div class="ingredientContainer" id="catList">

            {{#each categories}} 
              <div>
                <h4 class="categorySection" id="catButton{{this.id}}" data-catID="{{this.id}}">{{this.className}}<i class="fa fa-hand-o-right pull-right"></i></h4>
              </div>
            {{/each}}

          </div>
        </div>
      </div>
    </div>

    {{! ************* DIVISION FOR INGREDIENTS IN SELECTED CATEGORY ************************** -}}
    <div class="col-md-5">
      <div class="panel panel-default">
        <div class="panel-heading">Check Ingredients
        </div>

        <div class="panel-body">
          <div class="ingredientContainer" id="pantryList">

            {{#each categories}} 
              <div>
                <ul class = "list-group categoryUL catID{{this.id}} hidden">
                <h4>{{this.className}}</h4>
                <hr>
                {{! ***** ingredients go here}}
                </ul>
              </div>
            {{/each}}

          </div>
        </div>
      </div>
    </div>

    {{! ************* DIVISION FOR FORM TO ADD INGREDIENT}}
    <div class="col-md-3">
      <div class="equalHWrap eqWrap">
        <div class="containerTitle">
          <div class="panel panel-default">
            <div class="panel-heading">Add New Ingredient</div>
            <div class="panel-body">
              <form role="form" class="create-update-form" action="myPantry/update" method="POST">
                <div class="form-group">
                  <!-- Here we create the text box for capturing the search term-->
                  <label for="search">
                  </label>
                  </br>
                  <input type="text" class="form-control" id="bu" name="name">
                  </br>
                  <div class="categoryContainer" id="categoryList">
                    <select name="category" class="form-control" id="categoryOptions">

                    {{#each categories}}
                      <option value="{{this.name}}">{{this.className}}</option>
                    {{/each}}

                    </select>
                  </div>
                  </br>
                  </br>
                  </br>
                  <button id="add" type="submit" class="btn btn-default" ><i class="fa fa-check-square"></i> Add Now</button>
                  <button type="button" class="btn btn-default" id="clearAll"><i class="fa fa-trash"></i> Clear Results</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div> 

</div> {{!end of block div}}




{{!  ******************SCRIPT FILE HERE *****************}}
<script>
  {{! *** CREATE THE HTML FOR EACH INGREDIENT ****}}
  {{! ********* AND APPEND IT TO THE APPROPRIATE DIVISION *******}} 
  {{#each ingredients}}

    var ingredientLI = $('<li>');
    var statusStyle =({{this.inPantry}} ? "inPantryStyle" : "allOutStyle");
    var iconClass =({{this.inPantry}} ? "fa fa-check pull-right" : "fa fa-ban pull-right");
    var changeStatusTo = ({{this.inPantry}} ? "0" : "1");
    
    ingredientLI.append('<button data-id="{{this.id}}" data-pantryStatus="' + changeStatusTo + '" class="ingrButton ' + statusStyle + '" type="button">{{this.name}}<i class= "' + iconClass + '"></i></button>');

    $('#pantryList').find('.catID{{this.CategoryId}}').append(ingredientLI);    
  {{/each}}

  $(document).ready(function() {
  
    var target = '.catID' + '{{categories.[0].id}}';
    var catButton = '#catButton' + '{{categories.[0].id}}';

    $('#pantryList').find(target).toggleClass('hidden');
    $('#catList').find(catButton).toggleClass('chosenCat');

    $('.categorySection').on('click', function(event){
      event.stopPropagation();
      console.log("clicked ", target);
      $('#catList').find(catButton).toggleClass('chosenCat');
      $('#pantryList').find(target).toggleClass('hidden');


      var category = $(this).attr('data-catID');
      target = '.catID' + category;
      console.log("clicked ", target);
      catButton = $(this);

      $(this).toggleClass('chosenCat');
      $('#pantryList').find(target).toggleClass('hidden');
    })


    $('#pantryList').on('click', '.ingrButton', function(){
      var updateURL = "myPantry/update/" + $(this).attr('data-id');
      var ingButton = $(this);
      var value = $(this).attr('data-pantryStatus');
      $.post(updateURL,
        {inPantry: value}, 
        function(result){
          if(result == "0"){
            ingButton.removeClass('inPantryStyle');
            ingButton.find('i').removeClass('fa-check');
            ingButton.addClass('allOutStyle');
            ingButton.find('i').addClass('fa-ban');
            ingButton.attr('data-pantryStatus', '1');
          } else {
            ingButton.removeClass('allOutStyle');
            ingButton.find('i').removeClass('fa-ban');
            ingButton.addClass('inPantryStyle');
            ingButton.find('i').addClass('fa-check');
            ingButton.attr('data-pantryStatus', '0');
          }
        })
    });





  });


</script>